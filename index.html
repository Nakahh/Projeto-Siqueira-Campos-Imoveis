<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#8B4513" />

    <!-- Performance optimizations -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="dns-prefetch" href="//images.unsplash.com" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <!-- SEO Meta Tags -->
    <meta
      name="description"
      content="Sistema completo de gest√£o imobili√°ria - Siqueira Campos Im√≥veis. Encontre seu im√≥vel ideal em Goi√¢nia com seguran√ßa e profissionalismo."
    />
    <meta
      name="keywords"
      content="im√≥veis, casa, apartamento, venda, aluguel, Goi√¢nia, Siqueira Campos, gest√£o imobili√°ria"
    />
    <meta name="author" content="KRYONIX Tecnologia" />
    <meta name="robots" content="index, follow" />

    <!-- PWA Meta Tags -->
    <link rel="manifest" href="/manifest.json" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="Siqueira Campos" />

    <!-- Social Media Meta Tags -->
    <meta property="og:title" content="Siqueira Campos Im√≥veis" />
    <meta
      property="og:description"
      content="Sistema completo de gest√£o imobili√°ria profissional"
    />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="pt_BR" />

    <title>Siqueira Campos Im√≥veis - Sistema Profissional</title>

    <!-- Enhanced Performance & Debug System -->
    <script>
      // Performance tracking
      window.SiqueiraPerf = {
        start: Date.now(),
        marks: {},
      };

      // Mark performance points
      const mark = (name) => {
        window.SiqueiraPerf.marks[name] =
          Date.now() - window.SiqueiraPerf.start;
      };

      mark("html-parsed");

      console.log(
        "üöÄ Sistema Siqueira Campos Im√≥veis v2.0 - KRYONIX Technology",
      );

      // Enhanced environment detection
      window.SiqueiraDebug = {
        startTime: Date.now(),
        logs: [],
        errors: [],
        performance: window.SiqueiraPerf,
        environment: {
          url: window.location.href,
          userAgent: navigator.userAgent,
          viewport: { width: window.innerWidth, height: window.innerHeight },
          timestamp: new Date().toISOString(),
          isDev: window.location.hostname === "localhost",
        },
      };

      // Professional logging system
      const log = (level, message, data = null) => {
        const entry = {
          level,
          message,
          data,
          timestamp: Date.now() - window.SiqueiraDebug.startTime,
          stack: new Error().stack,
        };
        window.SiqueiraDebug.logs.push(entry);

        // Only log in development
        if (window.SiqueiraDebug.environment.isDev) {
          console[level](`[${entry.timestamp}ms] ${message}`, data || "");
        }
      };

      log(
        "info",
        "üè† Sistema Siqueira Campos Im√≥veis v2.0 - KRYONIX Technology",
      );
      log("info", "üîç Ambiente detectado", window.SiqueiraDebug.environment);

      // Enhanced fetch monitoring
      const originalFetch = window.fetch;
      window.fetch = function (url, options) {
        const urlString = typeof url === "string" ? url : url.toString();
        const startTime = Date.now();

        log("info", "üì° Fetch iniciado", { url: urlString, options });

        return originalFetch.apply(this, arguments).then(
          (response) => {
            const duration = Date.now() - startTime;
            log("info", "üì° Fetch conclu√≠do", {
              url: urlString,
              status: response.status,
              duration: `${duration}ms`,
            });
            return response;
          },
          (error) => {
            const duration = Date.now() - startTime;
            log("error", "üì° Fetch falhou", {
              url: urlString,
              error: error.message,
              duration: `${duration}ms`,
            });
            throw error;
          },
        );
      };

      // Enhanced error tracking
      window.addEventListener("error", (event) => {
        const errorInfo = {
          message: event.message,
          filename: event.filename,
          lineno: event.lineno,
          colno: event.colno,
          error: event.error,
          timestamp: Date.now(),
        };
        window.SiqueiraDebug.errors.push(errorInfo);
        log("error", "‚ùå JavaScript Error Detected", errorInfo);
      });

      window.addEventListener("unhandledrejection", (event) => {
        const errorInfo = {
          reason: event.reason,
          promise: event.promise,
          timestamp: Date.now(),
        };
        window.SiqueiraDebug.errors.push(errorInfo);
        log("error", "‚ùå Unhandled Promise Rejection", errorInfo);
      });

      mark("debug-initialized");
      log("info", "‚úÖ Enhanced debug system initialized");
    </script>

    <!-- Preload critical resources -->
    <link rel="modulepreload" href="/client/main.tsx" />
    <link rel="modulepreload" href="/client/App.tsx" />
    <link rel="stylesheet" href="/client/global.css" />
  </head>

  <body>
    <div id="root">
      <!-- Enhanced professional loading state -->
      <div
        id="loading-state"
        style="
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          min-height: 100vh;
          background: linear-gradient(135deg, #8b4513 0%, #d2b48c 100%);
          color: white;
          font-family:
            system-ui,
            -apple-system,
            BlinkMacSystemFont,
            &quot;Segoe UI&quot;,
            sans-serif;
          text-align: center;
          padding: 2rem;
        "
      >
        <div
          style="
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 3rem;
            max-width: 600px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            animation: fadeIn 0.8s ease-out;
          "
        >
          <h1 style="font-size: 3rem; margin-bottom: 1rem; font-weight: bold">
            üè† Siqueira Campos Im√≥veis
          </h1>
          <p style="font-size: 1.3rem; margin-bottom: 1rem; color: #ffe4b5">
            Sistema Profissional de Gest√£o Imobili√°ria v2.0
          </p>
          <p style="font-size: 1.1rem; margin-bottom: 2rem">
            Desenvolvido por <strong>KRYONIX Tecnologia</strong>
          </p>

          <div
            id="loading-progress"
            style="
              background: rgba(255, 255, 255, 0.2);
              border-radius: 0.5rem;
              padding: 1.5rem;
              margin-bottom: 2rem;
            "
          >
            <div
              style="
                width: 100%;
                height: 6px;
                background: rgba(255, 255, 255, 0.3);
                border-radius: 3px;
                margin-bottom: 1rem;
                overflow: hidden;
              "
            >
              <div
                id="progress-bar"
                style="
                  width: 0%;
                  height: 100%;
                  background: linear-gradient(90deg, #ffe4b5, #ffffff);
                  border-radius: 3px;
                  transition: width 0.3s ease;
                  animation: progressPulse 2s infinite;
                "
              ></div>
            </div>
            <p
              id="loading-text"
              style="color: #ffe4b5; margin: 0; font-size: 0.9rem"
            >
              üîß Inicializando sistema React v2.0...
            </p>
          </div>

          <div
            id="system-info"
            style="
              font-size: 0.85rem;
              color: rgba(255, 255, 255, 0.8);
              line-height: 1.5;
            "
          >
            <p>‚úÖ Sistema multi-dashboard enterprise ativo</p>
            <p>‚úÖ PWA profissional v2.0 configurado</p>
            <p>‚úÖ Seguran√ßa enterprise aprimorada</p>
            <p>‚úÖ API REST otimizada funcionando</p>
            <p>‚úÖ Performance monitoring ativo</p>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="/client/main.tsx"></script>

    <!-- Enhanced Service Worker Management -->
    <script>
      mark("scripts-loading");

      let loadingProgress = 0;
      const updateProgress = (percentage, text) => {
        loadingProgress = Math.min(percentage, 100);
        const progressBar = document.getElementById("progress-bar");
        const loadingText = document.getElementById("loading-text");
        if (progressBar) progressBar.style.width = loadingProgress + "%";
        if (loadingText) loadingText.textContent = text;
        log("info", "üìä Loading progress", {
          percentage: loadingProgress,
          text,
        });
      };

      updateProgress(10, "üîß Carregando recursos do sistema...");

      // Enhanced script loading monitoring
      const scripts = document.querySelectorAll("script[src]");
      let scriptsLoaded = 0;

      scripts.forEach((script) => {
        script.addEventListener("load", () => {
          scriptsLoaded++;
          const progress = 10 + (scriptsLoaded / scripts.length) * 50;
          updateProgress(
            progress,
            `üì¶ Carregando componentes (${scriptsLoaded}/${scripts.length})...`,
          );
        });

        script.addEventListener("error", (e) => {
          log("error", "‚ùå Script loading failed", {
            src: script.src,
            error: e,
          });
        });
      });

      // Enhanced Service Worker with comprehensive error handling
      if ("serviceWorker" in navigator) {
        updateProgress(70, "üîÑ Configurando Service Worker...");

        window.addEventListener("load", function () {
          navigator.serviceWorker
            .register("/sw.js")
            .then((registration) => {
              log(
                "info",
                "‚úÖ Service Worker registered successfully",
                registration,
              );
              updateProgress(85, "‚úÖ Service Worker ativo");
            })
            .catch((error) => {
              log(
                "warn",
                "‚ö†Ô∏è Service Worker registration failed (normal for development)",
                error,
              );
              updateProgress(85, "‚ö†Ô∏è Service Worker opcional (modo dev)");
            });
        });
      } else {
        updateProgress(85, "‚ö†Ô∏è Service Worker n√£o suportado");
      }

      // Enhanced timeout fallback
      const maxLoadingTime = 15000; // 15 seconds
      const fallbackTimeout = setTimeout(() => {
        const loadingState = document.getElementById("loading-state");
        if (loadingState && loadingState.style.display !== "none") {
          updateProgress(
            100,
            "‚è∞ Carregamento timeout - clique para continuar",
          );
          log("warn", "‚è∞ Loading timeout - showing fallback interface");

          const loadingText = document.getElementById("loading-text");
          if (loadingText) {
            loadingText.innerHTML = `
              <button onclick="window.location.reload()" style="
                padding: 1rem 2rem;
                background: white;
                color: #8B4513;
                border: none;
                border-radius: 0.5rem;
                font-size: 1rem;
                font-weight: bold;
                cursor: pointer;
                margin-top: 1rem;
                transition: all 0.3s ease;
              ">üîÑ Recarregar Sistema</button>
            `;
          }
        }
      }, maxLoadingTime);

      // Clear timeout when app loads successfully
      window.addEventListener("load", () => {
        clearTimeout(fallbackTimeout);
        mark("page-loaded");
      });

      mark("loading-system-initialized");
      log("info", "‚úÖ Enhanced loading system v2.0 initialized");
    </script>

    <!-- CSS animations for enhanced UX -->
    <style>
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes progressPulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
      }

      /* Performance optimizations */
      * {
        box-sizing: border-box;
      }

      html {
        -webkit-text-size-adjust: 100%;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      body {
        margin: 0;
        padding: 0;
        min-height: 100vh;
      }

      #root {
        min-height: 100vh;
      }
    </style>
  </body>
</html>
